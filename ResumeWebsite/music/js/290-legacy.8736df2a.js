(self["webpackChunkproject_music"]=self["webpackChunkproject_music"]||[]).push([[290],{4290:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return L}});var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"Search"},[r("div",{staticClass:"searchInput"},[r("i",{staticClass:"search-svg"}),r("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:"搜索歌曲、歌手、专辑"},domProps:{value:t.keywords},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.displayResult.apply(null,arguments)},input:[function(e){e.target.composing||(t.keywords=e.target.value)},function(e){return e.stopPropagation(),t.inputing.apply(null,arguments)}]}}),r("i",{directives:[{name:"show",rawName:"v-show",value:t.keywords.length>0,expression:"keywords.length>0"}],staticClass:"search-clear",on:{click:function(e){e.stopPropagation(),t.keywords=""}}})]),r("hr"),r(t.componentName,{tag:"component",attrs:{keywords:t.keywords},on:{searchWord:t.searchWord,play:function(e){return t.$emit("play",e)},suggestWord:t.suggestWord,historyWord:t.historyWord}})],1)},n=[],o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search-hot"},[r("h3",[t._v("热门搜索")]),r("ul",{staticClass:"hot-list"},t._l(t.hotSongs,(function(e,s){return r("li",{key:s,on:{click:function(r){return r.stopPropagation(),t.$emit("searchWord",e.first)}}},[t._v(t._s(e.first))])})),0),r("ol",{staticClass:"search-history"},[r("li",t._l(t.historyArr,(function(e){return r("div",{key:e,staticClass:"history-text",on:{click:function(r){return r.stopPropagation(),t.searchWord(r,e)}}},[r("i",{staticClass:"history-svg-1"}),t._v(" "+t._s(e)+" "),r("i",{staticClass:"history-svg-2",on:{click:function(r){return r.stopPropagation(),t.clearHistory(e)}}})])})),0)])])},i=[],a=r(6198),c=(r(7327),r(1539),r(8862),r(8975),{props:{keywords:{type:String,default:""}},data:function(){return{hotSongs:[],historyArr:[]}},created:function(){this.getHotSearch()},methods:{getHotSearch:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/search/hot").then((function(e){t.hotSongs=e.result.hots,t.getHistory()}));case 2:case"end":return e.stop()}}),e)})))()},getHistory:function(){var t=localStorage.getItem("searchhistory");t&&(this.historyArr=JSON.parse(t))},searchWord:function(t,e){this.$emit("searchWord",e)},clearHistory:function(t){var e=localStorage.getItem("searchhistory");e=JSON.parse(e).filter((function(e){return e!=t})),this.historyArr=e,localStorage.setItem("searchhistory",JSON.stringify(e))}}}),u=c,l=r(1001),h=(0,l.Z)(u,o,i,!1,null,"23c256f8",null),d=h.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search-result"},[r("div",{staticClass:"best-match",on:{click:function(e){e.stopPropagation(),t.isfull=!0}}},[t.bestMatch.length>0?r("span",{staticClass:"best-title"},[t._v("最佳匹配")]):t._e(),t._l(t.bestMatch,(function(e){return r("div",{key:e.id,staticClass:"best-gs",on:{click:function(r){return r.stopPropagation(),t.GetBestId(e.id)}}},[r("img",{staticClass:"best-tx",attrs:{src:e.picUrl,alt:""}}),t._v(" 歌手: "+t._s(e.name)+" "),r("div",{staticClass:"best-arr1"})])})),r("div",{staticClass:"best-zj"})],2),t._l(t.bestMatch,(function(t){return r("div",{key:t.id,staticClass:"singer-view"})})),t.showList.length>0?r("music-list",{attrs:{musiclist:t.showList},on:{play:function(e){return t.$emit("play",e)}}}):r("load-animate"),r("router-view"),r("div",{ref:"loadmore",staticClass:"loadmore"},[t._v(t._s(t.page?"正在努力赶来ing...":"没有更多啦(●'◡'●)"))])],2)},f=[];function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function y(t){if(Array.isArray(t))return p(t)}r(2526),r(1817),r(2165),r(8783),r(3948),r(1038);function m(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}r(7042),r(8309),r(4916),r(7601);function w(t,e){if(t){if("string"===typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}r(1703);function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(t){return y(t)||m(t)||w(t)||v()}r(1249),r(189);var S=r(5653),_=r(5976),b={props:{keywords:{type:String,default:""}},data:function(){return{resultSongs:[],bestMatch:[],isfull:!1,page:1}},created:function(){this.getSearchResult(),this.getBestMatch()},methods:{windowScroll:function(){var t=document.documentElement.scrollTop||document.body.scrollTop,e=this.$refs.loadmore.offsetTop,r=window.innerHeight;t+r>=e+33&&this.page++},getSearchResult:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/cloudsearch?keywords=".concat(t.keywords)).then((function(e){t.resultSongs=e.result.songs.map((function(t){return t.song={alias:t.alia,artists:t.ar,album:t.al},t}))}));case 2:case"end":return e.stop()}}),e)})))()},getBestMatch:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.setHistory(),e.next=3,t.axios.get("/search/multimatch?keywords=".concat(t.keywords)).then((function(e){t.bestMatch=e.result.artist}));case 3:case"end":return e.stop()}}),e)})))()},setHistory:function(){if(this.keywords&&""!=this.keywords&&!(this.keywords.length<1)){var t=localStorage.getItem("searchhistory"),e=[];t&&(e=JSON.parse(t)),e.unshift(this.keywords);var r=new Set(e);console.log(r),e=k(r),localStorage.setItem("searchhistory",JSON.stringify(e))}},GetBestId:function(t){this.$router.push({name:"SingerView",params:{id:t}})}},mounted:function(){window.addEventListener("scroll",this.windowScroll)},computed:{showList:function(){var t=20*this.page;return this.resultSongs.slice(0,t)}},components:{MusicList:S.Z,LoadAnimate:_.Z},beforeDestroy:function(){window.removeEventListener("scroll",this.windowScroll)}},C=b,x=(0,l.Z)(C,g,f,!1,null,"260820e4",null),R=x.exports,A=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search-suggest"},[r("h3",{staticClass:"suggest-title"},[t._v('搜索"'+t._s(t.keywords)+'"')]),r("div",{},[r("ol",{staticClass:"suggest-list"},t._l(t.suggestSongs,(function(e,s){return r("li",{key:e+s},[r("i",{staticClass:"list-svg"}),r("div",{staticClass:"list-text",on:{click:function(r){return r.stopPropagation(),t.$emit("suggestWord",e.keyword)}}},[t._v(t._s(e.keyword))])])})),0)])])},W=[],H=r(2196),N=r.n(H),$={props:{keywords:{type:String,default:""}},data:function(){return{suggestSongs:[]}},created:function(){this.getSearchSuggest()},methods:{getSearchSuggest:function(){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.axios.get("/search/suggest?keywords=".concat(t.keywords,"&type=mobile")).then((function(e){t.suggestSongs=e.result.allMatch}));case 2:case"end":return e.stop()}}),e)})))()}},watch:{keywords:N().debounce((function(){this.getSearchSuggest()}),1e3)}},I=$,M=(0,l.Z)(I,A,W,!1,null,"5ef619a0",null),Z=M.exports,E={data:function(){return{componentName:"SearchHots",keywords:""}},components:{SearchHots:d,SearchResult:R,SearchSuggest:Z},methods:{inputing:function(){""!=this.keywords||this.keywords.length>0?this.componentName="SearchSuggest":this.componentName="SearchHots"},displayResult:function(){this.componentName="SearchResult"},searchWord:function(t){this.keywords=t,this.displayResult()},historyWord:function(t){this.keywords=t,this.displayResult()},suggestWord:function(t){this.keywords=t,this.displayResult()}},watch:{keywords:{deep:!0,handler:function(){this.inputing()}}}},P=E,O=(0,l.Z)(P,s,n,!1,null,"62b56676",null),L=O.exports},8457:function(t,e,r){"use strict";var s=r(7854),n=r(9974),o=r(6916),i=r(7908),a=r(3411),c=r(7659),u=r(4411),l=r(6244),h=r(6135),d=r(8554),g=r(1246),f=s.Array;t.exports=function(t){var e=i(t),r=u(this),s=arguments.length,p=s>1?arguments[1]:void 0,y=void 0!==p;y&&(p=n(p,s>2?arguments[2]:void 0));var m,w,v,k,S,_,b=g(e),C=0;if(!b||this==f&&c(b))for(m=l(e),w=r?new this(m):f(m);m>C;C++)_=y?p(e[C],C):e[C],h(w,C,_);else for(k=d(e,b),S=k.next,w=r?new this:[];!(v=o(S,k)).done;C++)_=y?a(k,p,[v.value,C],!0):v.value,h(w,C,_);return w.length=C,w}},3411:function(t,e,r){var s=r(9670),n=r(9212);t.exports=function(t,e,r,o){try{return o?e(s(r)[0],r[1]):e(r)}catch(i){n(t,"throw",i)}}},1038:function(t,e,r){var s=r(2109),n=r(8457),o=r(7072),i=!o((function(t){Array.from(t)}));s({target:"Array",stat:!0,forced:i},{from:n})}}]);
//# sourceMappingURL=290-legacy.8736df2a.js.map