"use strict";(self["webpackChunkproject_music"]=self["webpackChunkproject_music"]||[]).push([[789],{8789:function(t,s,e){e.r(s),e.d(s,{default:function(){return P}});var r=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"Search"},[e("div",{staticClass:"searchInput"},[e("i",{staticClass:"search-svg"}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:"搜索歌曲、歌手、专辑"},domProps:{value:t.keywords},on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.displayResult.apply(null,arguments)},input:[function(s){s.target.composing||(t.keywords=s.target.value)},function(s){return s.stopPropagation(),t.inputing.apply(null,arguments)}]}}),e("i",{directives:[{name:"show",rawName:"v-show",value:t.keywords.length>0,expression:"keywords.length>0"}],staticClass:"search-clear",on:{click:function(s){s.stopPropagation(),t.keywords=""}}})]),e("hr"),e(t.componentName,{tag:"component",attrs:{keywords:t.keywords},on:{searchWord:t.searchWord,play:function(s){return t.$emit("play",s)},suggestWord:t.suggestWord,historyWord:t.historyWord}})],1)},o=[],i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"search-hot"},[e("h3",[t._v("热门搜索")]),e("ul",{staticClass:"hot-list"},t._l(t.hotSongs,(function(s,r){return e("li",{key:r,on:{click:function(e){return e.stopPropagation(),t.$emit("searchWord",s.first)}}},[t._v(t._s(s.first))])})),0),e("ol",{staticClass:"search-history"},[e("li",t._l(t.historyArr,(function(s){return e("div",{key:s,staticClass:"history-text",on:{click:function(e){return e.stopPropagation(),t.searchWord(e,s)}}},[e("i",{staticClass:"history-svg-1"}),t._v(" "+t._s(s)+" "),e("i",{staticClass:"history-svg-2",on:{click:function(e){return e.stopPropagation(),t.clearHistory(s)}}})])})),0)])])},a=[],n={props:{keywords:{type:String,default:""}},data(){return{hotSongs:[],historyArr:[]}},created(){this.getHotSearch()},methods:{async getHotSearch(){await this.axios.get("/search/hot").then((t=>{this.hotSongs=t.result.hots,this.getHistory()}))},getHistory(){let t=localStorage.getItem("searchhistory");t&&(this.historyArr=JSON.parse(t))},searchWord(t,s){this.$emit("searchWord",s)},clearHistory(t){let s=localStorage.getItem("searchhistory");s=JSON.parse(s).filter((s=>s!=t)),this.historyArr=s,localStorage.setItem("searchhistory",JSON.stringify(s))}}},l=n,c=e(1001),h=(0,c.Z)(l,i,a,!1,null,"23c256f8",null),u=h.exports,d=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"search-result"},[e("div",{staticClass:"best-match",on:{click:function(s){s.stopPropagation(),t.isfull=!0}}},[t.bestMatch.length>0?e("span",{staticClass:"best-title"},[t._v("最佳匹配")]):t._e(),t._l(t.bestMatch,(function(s){return e("div",{key:s.id,staticClass:"best-gs",on:{click:function(e){return e.stopPropagation(),t.GetBestId(s.id)}}},[e("img",{staticClass:"best-tx",attrs:{src:s.picUrl,alt:""}}),t._v(" 歌手: "+t._s(s.name)+" "),e("div",{staticClass:"best-arr1"})])})),e("div",{staticClass:"best-zj"})],2),t._l(t.bestMatch,(function(t){return e("div",{key:t.id,staticClass:"singer-view"})})),t.showList.length>0?e("music-list",{attrs:{musiclist:t.showList},on:{play:function(s){return t.$emit("play",s)}}}):e("load-animate"),e("router-view"),e("div",{ref:"loadmore",staticClass:"loadmore"},[t._v(t._s(t.page?"正在努力赶来ing...":"没有更多啦(●'◡'●)"))])],2)},g=[],y=e(5653),p=e(5976),m={props:{keywords:{type:String,default:""}},data(){return{resultSongs:[],bestMatch:[],isfull:!1,page:1}},created(){this.getSearchResult(),this.getBestMatch()},methods:{windowScroll(){let t=document.documentElement.scrollTop||document.body.scrollTop,s=this.$refs.loadmore.offsetTop,e=window.innerHeight;t+e>=s+33&&this.page++},async getSearchResult(){await this.axios.get(`/cloudsearch?keywords=${this.keywords}`).then((t=>{this.resultSongs=t.result.songs.map((t=>(t.song={alias:t.alia,artists:t.ar,album:t.al},t)))}))},async getBestMatch(){this.setHistory(),await this.axios.get(`/search/multimatch?keywords=${this.keywords}`).then((t=>{this.bestMatch=t.result.artist}))},setHistory(){if(!this.keywords||""==this.keywords||this.keywords.length<1)return;let t=localStorage.getItem("searchhistory"),s=[];t&&(s=JSON.parse(t)),s.unshift(this.keywords);let e=new Set(s);console.log(e),s=[...e],localStorage.setItem("searchhistory",JSON.stringify(s))},GetBestId(t){this.$router.push({name:"SingerView",params:{id:t}})}},mounted(){window.addEventListener("scroll",this.windowScroll)},computed:{showList(){let t=20*this.page;return this.resultSongs.slice(0,t)}},components:{MusicList:y.Z,LoadAnimate:p.Z},beforeDestroy(){window.removeEventListener("scroll",this.windowScroll)}},w=m,k=(0,c.Z)(w,d,g,!1,null,"260820e4",null),f=k.exports,S=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"search-suggest"},[e("h3",{staticClass:"suggest-title"},[t._v('搜索"'+t._s(t.keywords)+'"')]),e("div",{},[e("ol",{staticClass:"suggest-list"},t._l(t.suggestSongs,(function(s,r){return e("li",{key:s+r},[e("i",{staticClass:"list-svg"}),e("div",{staticClass:"list-text",on:{click:function(e){return e.stopPropagation(),t.$emit("suggestWord",s.keyword)}}},[t._v(t._s(s.keyword))])])})),0)])])},v=[],_=e(2196),C=e.n(_),b={props:{keywords:{type:String,default:""}},data(){return{suggestSongs:[]}},created(){this.getSearchSuggest()},methods:{async getSearchSuggest(){await this.axios.get(`/search/suggest?keywords=${this.keywords}&type=mobile`).then((t=>{this.suggestSongs=t.result.allMatch}))}},watch:{keywords:C().debounce((function(){this.getSearchSuggest()}),1e3)}},x=b,W=(0,c.Z)(x,S,v,!1,null,"5ef619a0",null),$=W.exports,H={data(){return{componentName:"SearchHots",keywords:""}},components:{SearchHots:u,SearchResult:f,SearchSuggest:$},methods:{inputing(){""!=this.keywords||this.keywords.length>0?this.componentName="SearchSuggest":this.componentName="SearchHots"},displayResult(){this.componentName="SearchResult"},searchWord(t){this.keywords=t,this.displayResult()},historyWord(t){this.keywords=t,this.displayResult()},suggestWord(t){this.keywords=t,this.displayResult()}},watch:{keywords:{deep:!0,handler(){this.inputing()}}}},N=H,M=(0,c.Z)(N,r,o,!1,null,"62b56676",null),P=M.exports}}]);
//# sourceMappingURL=789.b77b5f1a.js.map